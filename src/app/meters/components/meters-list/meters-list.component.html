<section class="meters-list">
  <header>
    <h2>Учёт показаний</h2>
    <p>Все объекты и ресурсы в одном интерфейсе для своевременной передачи данных.</p>
  </header>

  <mat-card>
    <mat-card-title>Последние показания</mat-card-title>
    <ng-container *ngIf="readings$ | async as readings; else emptyState">
      <table *ngIf="readings.length; else emptyState">
        <thead>
          <tr>
            <th>Объект</th>
            <th>Ресурс</th>
            <th>Показания</th>
            <th>Расход</th>
            <th>Стоимость</th>
            <th>Дата</th>
            <th class="meters-list__actions">Действия</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let reading of readings; trackBy: trackReading">
            <td>{{ reading.objectName }}</td>
            <td>
              <div class="meters-list__resource">
                <span>{{ reading.resourceName }}</span>
                <small>{{ reading.typeLabel }}</small>
              </div>
            </td>
            <td>{{ formatValues(reading) }}</td>
            <td>
              <ng-container *ngIf="reading.zones.length; else noConsumption">
                {{ formatConsumption(reading) }}
              </ng-container>
            </td>
            <td>
              <ng-container *ngIf="formatCost(reading) as cost; else noCost">{{ cost }}</ng-container>
            </td>
            <td>{{ reading.submittedAt | date: 'd MMMM yyyy' }}</td>
            <td class="meters-list__actions">
              <a mat-button color="primary" [routerLink]="[reading.id, 'edit']">Редактировать</a>
              <a mat-button [routerLink]="['../', reading.resourceId]">Детали</a>
            </td>
          </tr>
        </tbody>
      </table>
    </ng-container>
  </mat-card>

  <ng-template #noConsumption>—</ng-template>
  <ng-template #noCost>—</ng-template>
  <ng-template #emptyState>
    <p class="meters-list__empty">Пока нет ни одного показания. Добавьте первое, чтобы отслеживать изменения.</p>
  </ng-template>
</section>
