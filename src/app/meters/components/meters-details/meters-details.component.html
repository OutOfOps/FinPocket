<div class="meters-details">
  <header class="meters-details__header">
    <button mat-icon-button class="back-btn" routerLink="../../list">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <h2>Детали счётчика</h2>
  </header>

  <div class="meters-details__content">
    @if (summary) {
    <!-- Summary Card -->
    <div class="detail-summary-card">
      <div class="icon-wrapper">
        <mat-icon>{{ typeIcon(summary.resource.type) }}</mat-icon>
      </div>
      <h1>{{ summary.resource.name }}</h1>
      <span class="object-name">{{ summary.object.name }}</span>

      <div class="stats-grid">
        <div class="stat-item">
          <span class="label">Тип</span>
          <span class="value">{{ typeLabel(summary.resource.type) }}</span>
        </div>
        <div class="stat-item">
          <span class="label">Тариф</span>
          <span class="value">{{ zoneName() }}</span>
        </div>
        <div class="stat-item">
          <span class="label">Зон учёта</span>
          <span class="value">{{ zoneSummaryText() }}</span>
        </div>
        <div class="stat-item">
          <span class="label">Модель</span>
          <span class="value">{{ pricingLabel(summary.resource) }}</span>
        </div>
      </div>
    </div>

    <!-- History -->
    <section class="history-section">
      <h3>История показаний</h3>

      @if (readings.length) {
      @for (reading of readings; track trackReading($index, reading)) {
      <div class="history-card" mat-ripple [routerLink]="['../../', reading.id, 'edit']">
        <div class="history-date">
          <span class="day">{{ reading.submittedAt | date: 'd MMM' }}</span>
          <span class="year">{{ reading.submittedAt | date: 'yyyy' }}</span>
        </div>

        <div class="history-values">
          @for (val of reading.values; track val.label) {
          <div>
            <span class="main-value">{{ val.value }}</span>
            <span class="sub-value">{{ val.label }}</span>
          </div>
          }
        </div>

        @if (reading.cost !== undefined) {
        <div class="history-cost">
          {{ formatCurrency(reading.cost, reading.currency) }}
        </div>
        }
      </div>
      }
      } @else {
      <div class="empty-state">
        <p>Нет истории показаний</p>
      </div>
      }
    </section>

    } @else {
    <div class="empty-state">
      <p>Загрузка данных...</p>
    </div>
    }
  </div>
</div>