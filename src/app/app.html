<div class="app-layout">
  <!-- Top Header (Sticky) -->
  <header class="app-header">
    <div class="header-content">
      <div class="header-brand">
        <span class="header-title">FinPocket</span>
        <span class="header-version" style="cursor: pointer;" (click)="checkUpdate()"
          matTooltip="Нажмите для проверки обновлений">
          {{ appVersion }}
        </span>
      </div>

      <div class="header-actions">
        <!-- Theme/Accent Cycler -->
        <button mat-icon-button (click)="cycleTheme()" matTooltip="Сменить цвет">
          <mat-icon class="icon-gradient">palette</mat-icon>
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content Area -->
  <main class="app-main" [@routeAnimations]="o.isActivated ? o.activatedRoute : ''">
    <!-- Router Outlet -->
    <router-outlet #o="outlet"></router-outlet>

    <!-- Safe spacing for bottom nav -->
    <div class="bottom-nav-spacer"></div>
  </main>

  <!-- Bottom Navigation Bar -->
  <nav class="bottom-nav">
    <a *ngFor="let item of navItems" [routerLink]="item.route" routerLinkActive="active" class="nav-item" mat-ripple>
      <mat-icon>{{ item.icon }}</mat-icon>
      <!-- Labels removed for minimalism, or maybe show active only? Let's show none as per 'Neo' plan -->
    </a>

    <!-- Settings Tab (Explicit) -->
    <a routerLink="/settings" routerLinkActive="active" class="nav-item" mat-ripple>
      <mat-icon>settings</mat-icon>
    </a>
  </nav>

  <!-- FAB (Floating Action Button) -->
  <button mat-fab class="fab-main" color="primary" (click)="openQuickActions(quickActionsTpl)">
    <mat-icon>add</mat-icon>
  </button>
</div>

<ng-template #quickActionsTpl>
  <div class="quick-actions-sheet">
    <div class="sheet-header">Добавить</div>
    <mat-nav-list>
      <a mat-list-item routerLink="/finance/create" (click)="bottomSheet.dismiss()">
        <mat-icon matListItemIcon>account_balance_wallet</mat-icon>
        <span matListItemTitle>Транзакция</span>
      </a>
      <a mat-list-item routerLink="/debts/create" (click)="bottomSheet.dismiss()">
        <mat-icon matListItemIcon>handshake</mat-icon>
        <span matListItemTitle>Долг</span>
      </a>
      <a mat-list-item routerLink="/meters/create" (click)="bottomSheet.dismiss()">
        <mat-icon matListItemIcon>speed</mat-icon>
        <span matListItemTitle>Показания</span>
      </a>
    </mat-nav-list>
  </div>
</ng-template>