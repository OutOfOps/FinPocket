@use '@angular/material' as mat;
@use 'sass:map';
@use 'sass:color';

$finpocket-headline-font: 'Poppins', 'Inter', sans-serif;
$finpocket-text-font: 'Inter', 'Roboto', 'Segoe UI', system-ui, -apple-system, sans-serif;

$finpocket-typography: mat.m2-define-typography-config($font-family: $finpocket-text-font,
    $headline-1: mat.m2-define-typography-level(96px, 112px, 600, $finpocket-headline-font, -1.5px),
    $headline-2: mat.m2-define-typography-level(60px, 72px, 600, $finpocket-headline-font, -0.5px),
    $headline-3: mat.m2-define-typography-level(48px, 56px, 600, $finpocket-headline-font, 0px),
    $headline-4: mat.m2-define-typography-level(34px, 40px, 600, $finpocket-headline-font, 0px),
    $headline-5: mat.m2-define-typography-level(24px, 32px, 600, $finpocket-headline-font, 0px),
    $headline-6: mat.m2-define-typography-level(20px, 28px, 600, $finpocket-headline-font, 0px),
    $subtitle-1: mat.m2-define-typography-level(16px, 24px, 500, $finpocket-headline-font, 0.15px),
    $subtitle-2: mat.m2-define-typography-level(14px, 20px, 600, $finpocket-headline-font, 0.1px),
    $body-1: mat.m2-define-typography-level(16px, 24px, 400, $finpocket-text-font, 0.15px),
    $body-2: mat.m2-define-typography-level(14px, 20px, 400, $finpocket-text-font, 0.1px),
    $button: mat.m2-define-typography-level(14px, 16px, 600, $finpocket-headline-font, 0.75px),
    $caption: mat.m2-define-typography-level(12px, 16px, 400, $finpocket-text-font, 0.4px),
    $overline: mat.m2-define-typography-level(12px, 16px, 600, $finpocket-headline-font, 1px));

// Define palettes
$palette-blue: mat.m2-define-palette(mat.$m2-blue-palette, 500, 300, 700);
$palette-green: mat.m2-define-palette(mat.$m2-green-palette, A400, A200, A700);
$palette-purple: mat.m2-define-palette(mat.$m2-deep-purple-palette, A200, A100, A400);
$palette-orange: mat.m2-define-palette(mat.$m2-orange-palette, 500, 300, 700);
$palette-warn: mat.m2-define-palette(mat.$m2-red-palette, 500);

// Helpers
@function to-rgb-string($color) {
  @return "#{color.red($color)}, #{color.green($color)}, #{color.blue($color)}";
}

// Default theme (Purple/Orange)
$default-primary: $palette-purple;
$default-accent: $palette-orange;

$finpocket-dark-theme: mat.m2-define-dark-theme((color: (primary: $default-primary,
        accent: $default-accent,
        warn: $palette-warn,
      ),
      typography: $finpocket-typography,
    ));

$finpocket-light-theme: mat.m2-define-light-theme((color: (primary: $default-primary,
        accent: $default-accent,
        warn: $palette-warn,
      ),
      typography: $finpocket-typography,
    ));

@mixin apply() {
  @include mat.core();

  // Base themes
  .finpocket-dark-theme {
    @include mat.all-component-colors($finpocket-dark-theme);
    @include mat.all-component-typographies($finpocket-dark-theme);

    $primary-500: mat.m2-get-color-from-palette($default-primary, 500);
    $accent-500: mat.m2-get-color-from-palette($default-accent, 500);

    --finpocket-primary: #{$primary-500};
    --finpocket-primary-color: #{$primary-500};
    --finpocket-primary-rgb: #{to-rgb-string($primary-500)};
    --finpocket-accent: #{$accent-500};
    --finpocket-accent-color: #{$accent-500};
    --finpocket-accent-rgb: #{to-rgb-string($accent-500)};

    // OLED Colors
    --finpocket-bg-app: #000000;
    --finpocket-bg-surface: #121212;
    --finpocket-bg-surface-2: #1e1e1e;
    --finpocket-border-color: #333333;

    // Default Accent (Purple)
    --finpocket-card-shadow: 0 22px 50px rgba(0, 0, 0, 0.45);
    --finpocket-surface-elevated: #1a1a1a;
    --finpocket-ghost-surface: rgba(255, 255, 255, 0.08);
    --finpocket-ghost-strong: rgba(255, 255, 255, 0.14);

    // Glass & Charts (Dark)
    --finpocket-glass-bg: rgba(30, 30, 30, 0.6);
    --finpocket-glass-border: rgba(255, 255, 255, 0.08);
    --finpocket-input-bg: rgba(255, 255, 255, 0.05);
    --finpocket-chart-text-color: rgba(255, 255, 255, 0.82);
    --finpocket-chart-grid-color: rgba(255, 255, 255, 0.12);
    --finpocket-chart-tooltip-bg: rgba(20, 20, 30, 0.92);
    --finpocket-chart-tooltip-text: #fefefe;
  }

  .finpocket-light-theme {
    @include mat.all-component-colors($finpocket-light-theme);
    @include mat.all-component-typographies($finpocket-light-theme);

    $primary-500: mat.m2-get-color-from-palette($default-primary, 500);
    $accent-500: mat.m2-get-color-from-palette($default-accent, 500);

    --finpocket-primary: #{$primary-500};
    --finpocket-primary-color: #{$primary-500};
    --finpocket-primary-rgb: #{to-rgb-string($primary-500)};
    --finpocket-accent: #{$accent-500};
    --finpocket-accent-color: #{$accent-500};
    --finpocket-accent-rgb: #{to-rgb-string($accent-500)};

    --finpocket-bg-app: #eef1f6;
    --finpocket-bg-surface: #ffffff;
    --finpocket-bg-surface-2: #f7f9fc;
    --finpocket-border-color: #d6dbe3;

    --finpocket-primary-color: #{mat.m2-get-color-from-palette($palette-purple, 500)};
    --finpocket-accent-color: #{mat.m2-get-color-from-palette($palette-orange, 500)};
    --finpocket-text: #0b0c15;
    --finpocket-subtle: #4b5563;
    --finpocket-muted: #6b7280;
    --finpocket-card-shadow: 0 14px 30px rgba(15, 23, 42, 0.12);
    --finpocket-surface-elevated: #ffffff;
    --finpocket-ghost-surface: #eef2f7;
    --finpocket-ghost-strong: #e2e8f0;

    // Glass & Charts (Light)
    --finpocket-glass-bg: rgba(255, 255, 255, 0.9);
    --finpocket-glass-border: rgba(15, 23, 42, 0.08);
    --finpocket-input-bg: rgba(15, 23, 42, 0.05);
    --finpocket-chart-text-color: rgba(15, 23, 42, 0.86);
    --finpocket-chart-grid-color: rgba(15, 23, 42, 0.08);
    --finpocket-chart-tooltip-bg: rgba(255, 255, 255, 0.98);
    --finpocket-chart-tooltip-text: #0f172a;
  }

  // Color Variants (Overrides)
  // Usage: <body class="finpocket-dark-theme acc-blue">

  .acc-blue {
    $theme: mat.m2-define-dark-theme((color: (primary: $palette-blue, accent: $palette-blue, warn: $palette-warn)));
    @include mat.all-component-colors($theme);
    $primary-500: mat.m2-get-color-from-palette($palette-blue, 500);
    $accent-200: mat.m2-get-color-from-palette($palette-blue, A200);
    --finpocket-primary: #{$primary-500};
    --finpocket-primary-color: #{$primary-500};
    --finpocket-primary-rgb: #{to-rgb-string($primary-500)};
    --finpocket-accent: #{$accent-200};
    --finpocket-accent-color: #{$accent-200};
    --finpocket-accent-rgb: #{to-rgb-string($accent-200)};
  }

  .acc-green {
    $theme: mat.m2-define-dark-theme((color: (primary: $palette-green, accent: $palette-green, warn: $palette-warn)));
    @include mat.all-component-colors($theme);
    $primary-a400: mat.m2-get-color-from-palette($palette-green, A400);
    $accent-a200: mat.m2-get-color-from-palette($palette-green, A200);
    --finpocket-primary: #{$primary-a400};
    --finpocket-primary-color: #{$primary-a400};
    --finpocket-primary-rgb: #{to-rgb-string($primary-a400)};
    --finpocket-accent: #{$accent-a200};
    --finpocket-accent-color: #{$accent-a200};
    --finpocket-accent-rgb: #{to-rgb-string($accent-a200)};
  }

  .acc-orange {
    $theme: mat.m2-define-dark-theme((color: (primary: $palette-orange, accent: $palette-orange, warn: $palette-warn)));
    @include mat.all-component-colors($theme);
    $primary-500: mat.m2-get-color-from-palette($palette-orange, 500);
    $accent-a200: mat.m2-get-color-from-palette($palette-orange, A200);
    --finpocket-primary: #{$primary-500};
    --finpocket-primary-color: #{$primary-500};
    --finpocket-primary-rgb: #{to-rgb-string($primary-500)};
    --finpocket-accent: #{$accent-a200};
    --finpocket-accent-color: #{$accent-a200};
    --finpocket-accent-rgb: #{to-rgb-string($accent-a200)};
  }
}